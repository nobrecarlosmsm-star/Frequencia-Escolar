<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema de Frequ√™ncia Escolar Profissional">
    <meta name="theme-color" content="#6366f1">
    <title>Frequ√™ncia Escolar Pro</title>
    
    <link rel="manifest" id="manifest-placeholder">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üìö</text></svg>">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-slideup { animation: slideUp 0.5s ease; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-spin { animation: spin 1s linear infinite; }
        @media print { .no-print { display: none !important; } body { background: white !important; } }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .login-card { backdrop-filter: blur(10px); background: rgba(255, 255, 255, 0.95); }
        .percentage-bar { transition: width 0.5s ease; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // CONFIGURA√á√ïES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const DEFAULT_USERS = {
            admin: { password: 'admin123', role: 'admin', name: 'Administrador Principal' }
        };

        const STUDENT_STATUS = {
            ATIVO: 'ativo',
            TRANSFERIDO: 'transferido',
            FALECIDO: 'falecido'
        };

        const SYNC_CONFIG = {
            ENABLED: true,
            API_URL: 'https://api.jsonbin.io/v3'
        };

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // √çCONES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const Icon = ({ type, size = 24 }) => {
            const paths = {
                user: "M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8z",
                lock: "M19 11h-1V7a6 6 0 0 0-12 0v4H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2z",
                users: "M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M9 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75",
                plus: "M12 5v14M5 12h14",
                trash: "M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",
                cloud: "M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z",
                refresh: "M23 4v6h-6M1 20v-6h6M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15",
                settings: "M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z",
                download: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3",
                upload: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12",
                x: "M18 6L6 18M6 6l12 12",
                logout: "M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9",
                printer: "M6 9V2h12v7M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2M6 14h12v8H6z",
                check: "M20 6L9 17l-5-5",
                edit: "M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d={paths[type]} />
                </svg>
            );
        };

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // SINCRONIZA√á√ÉO
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        class SyncManager {
            static getApiKey() {
                return localStorage.getItem('jsonbin_api_key') || '';
            }

            static async save(data) {
                const apiKey = this.getApiKey();
                if (!apiKey) return false;
                
                try {
                    const binId = localStorage.getItem('syncBinId');
                    const url = binId 
                        ? `${SYNC_CONFIG.API_URL}/b/${binId}`
                        : `${SYNC_CONFIG.API_URL}/b`;
                    
                    const response = await fetch(url, {
                        method: binId ? 'PUT' : 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': apiKey.trim()
                        },
                        body: JSON.stringify({
                            ...data,
                            lastSync: new Date().toISOString()
                        })
                    });
                    
                    if (!response.ok) throw new Error(`Erro ${response.status}`);
                    
                    const result = await response.json();
                    const newBinId = result.metadata?.id || binId;
                    
                    if (newBinId) {
                        localStorage.setItem('syncBinId', newBinId);
                    }
                    
                    return true;
                } catch (error) {
                    console.error('Erro ao sincronizar:', error);
                    throw error;
                }
            }

            static async load() {
                const apiKey = this.getApiKey();
                if (!apiKey) return null;
                
                try {
                    const binId = localStorage.getItem('syncBinId');
                    if (!binId) return null;
                    
                    const response = await fetch(`${SYNC_CONFIG.API_URL}/b/${binId}/latest`, {
                        headers: { 'X-Master-Key': apiKey.trim() }
                    });
                    
                    if (!response.ok) return null;
                    
                    const result = await response.json();
                    return result.record;
                } catch {
                    return null;
                }
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // MODAL TROCAR SENHA/USU√ÅRIO
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function ChangeCredentialsModal({ user, users, setUsers, onClose, onUpdate }) {
            const [currentPassword, setCurrentPassword] = useState('');
            const [newUsername, setNewUsername] = useState(user.username);
            const [newPassword, setNewPassword] = useState('');
            const [confirmPassword, setConfirmPassword] = useState('');

            const handleSave = () => {
                // Verificar senha atual
                if (users[user.username].password !== currentPassword) {
                    return alert('‚ùå Senha atual incorreta!');
                }

                // Verificar se novo usu√°rio j√° existe
                if (newUsername !== user.username && users[newUsername]) {
                    return alert('‚ùå Nome de usu√°rio j√° existe!');
                }

                // Se est√° mudando senha, verificar confirma√ß√£o
                if (newPassword) {
                    if (newPassword !== confirmPassword) {
                        return alert('‚ùå Senhas n√£o conferem!');
                    }
                    if (newPassword.length < 6) {
                        return alert('‚ùå Senha deve ter no m√≠nimo 6 caracteres!');
                    }
                }

                // Atualizar usu√°rio
                const newUsers = { ...users };
                const userData = { ...users[user.username] };
                
                // Atualizar senha se fornecida
                if (newPassword) {
                    userData.password = newPassword;
                }

                // Se mudou o username
                if (newUsername !== user.username) {
                    delete newUsers[user.username];
                    newUsers[newUsername] = userData;
                } else {
                    newUsers[user.username] = userData;
                }

                setUsers(newUsers);
                
                // Atualizar sess√£o do usu√°rio
                const updatedUser = {
                    ...user,
                    username: newUsername
                };
                
                localStorage.setItem('currentUser', JSON.stringify(updatedUser));
                onUpdate(updatedUser);
                
                alert('‚úÖ Credenciais atualizadas com sucesso!');
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg w-full max-w-md p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold">üîê Alterar Credenciais</h2>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-700">
                                <Icon type="x" size={24} />
                            </button>
                        </div>

                        <div className="space-y-4">
                            <div>
                                <label className="block text-sm font-semibold mb-2">Senha Atual *</label>
                                <input
                                    type="password"
                                    value={currentPassword}
                                    onChange={(e) => setCurrentPassword(e.target.value)}
                                    className="w-full p-3 border-2 rounded-lg"
                                    placeholder="Digite sua senha atual"
                                    required
                                />
                            </div>

                            <div className="border-t pt-4">
                                <h3 className="font-semibold mb-3">Novo Nome de Usu√°rio</h3>
                                <input
                                    type="text"
                                    value={newUsername}
                                    onChange={(e) => setNewUsername(e.target.value)}
                                    className="w-full p-3 border-2 rounded-lg"
                                    placeholder="Novo nome de usu√°rio"
                                />
                            </div>

                            <div className="border-t pt-4">
                                <h3 className="font-semibold mb-3">Nova Senha (opcional)</h3>
                                <input
                                    type="password"
                                    value={newPassword}
                                    onChange={(e) => setNewPassword(e.target.value)}
                                    className="w-full p-3 border-2 rounded-lg mb-3"
                                    placeholder="Nova senha (m√≠nimo 6 caracteres)"
                                />
                                <input
                                    type="password"
                                    value={confirmPassword}
                                    onChange={(e) => setConfirmPassword(e.target.value)}
                                    className="w-full p-3 border-2 rounded-lg"
                                    placeholder="Confirme a nova senha"
                                />
                            </div>

                            <div className="flex gap-3 pt-4">
                                <button
                                    onClick={handleSave}
                                    className="flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 font-semibold"
                                >
                                    ‚úÖ Salvar Altera√ß√µes
                                </button>
                                <button
                                    onClick={onClose}
                                    className="px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700"
                                >
                                    Cancelar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // CONFIG MODAL
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function ConfigModal({ onClose, onSave }) {
            const [apiKey, setApiKey] = useState(() => localStorage.getItem('jsonbin_api_key') || '');

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg w-full max-w-2xl p-6">
                        <div className="flex justify-between items-center mb-4">
                            <h2 className="text-2xl font-bold">‚öôÔ∏è Configurar API</h2>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-700">
                                <Icon type="x" size={24} />
                            </button>
                        </div>

                        <div className="space-y-4">
                            <div className="bg-blue-50 p-4 rounded-lg">
                                <p className="text-sm text-blue-800">
                                    <strong>1.</strong> Acesse jsonbin.io<br/>
                                    <strong>2.</strong> V√° em API Keys<br/>
                                    <strong>3.</strong> Crie uma Master Key<br/>
                                    <strong>4.</strong> Cole abaixo
                                </p>
                            </div>

                            <textarea
                                value={apiKey}
                                onChange={(e) => setApiKey(e.target.value)}
                                className="w-full p-3 border-2 rounded-lg font-mono text-sm h-24"
                                placeholder="Cole sua API Key aqui..."
                            />

                            <div className="flex gap-3">
                                <button
                                    onClick={() => {
                                        if (apiKey.trim()) {
                                            onSave(apiKey.trim());
                                            onClose();
                                        }
                                    }}
                                    className="flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 font-semibold"
                                >
                                    ‚úÖ Salvar
                                </button>
                                <button
                                    onClick={onClose}
                                    className="px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700"
                                >
                                    Cancelar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // LOGIN
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function LoginScreen({ onLogin, users }) {
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                
                const user = users[username];
                
                if (!user) {
                    alert('‚ùå Usu√°rio n√£o encontrado!');
                    return;
                }
                
                if (user.password !== password) {
                    alert('‚ùå Senha incorreta!');
                    return;
                }
                
                onLogin({
                    username,
                    name: user.name,
                    role: user.role,
                    canEdit: user.role === 'admin' || user.role === 'alimentador',
                    canManageStudents: user.role === 'admin',
                    canManageUsers: user.role === 'admin'
                });
            };

            return (
                <div className="min-h-screen gradient-bg flex items-center justify-center p-4">
                    <div className="login-card rounded-2xl shadow-2xl p-8 w-full max-w-md animate-slideup">
                        <div className="text-center mb-8">
                            <div className="text-6xl mb-4">üìö</div>
                            <h1 className="text-3xl font-bold text-gray-800">Frequ√™ncia Escolar</h1>
                            <p className="text-gray-600 mt-2">Sistema Profissional</p>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-semibold mb-2">Usu√°rio</label>
                                <input
                                    type="text"
                                    value={username}
                                    onChange={(e) => setUsername(e.target.value)}
                                    className="w-full p-3 border-2 rounded-lg focus:border-indigo-500 focus:outline-none"
                                    required
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-semibold mb-2">Senha</label>
                                <input
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    className="w-full p-3 border-2 rounded-lg focus:border-indigo-500 focus:outline-none"
                                    required
                                />
                            </div>

                            <button
                                type="submit"
                                className="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700"
                            >
                                Entrar
                            </button>
                        </form>

                        <div className="mt-6 p-4 bg-gray-100 rounded-lg text-sm">
                            <p className="font-semibold mb-2">Acesso padr√£o:</p>
                            <p className="font-mono">admin / admin123</p>
                        </div>
                    </div>
                </div>
            );
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // GERENCIAR USU√ÅRIOS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function ManageUsers({ users, setUsers, onClose }) {
            const [newUsername, setNewUsername] = useState('');
            const [newPassword, setNewPassword] = useState('');
            const [newName, setNewName] = useState('');
            const [newRole, setNewRole] = useState('alimentador');

            const addUser = () => {
                if (!newUsername || !newPassword || !newName) {
                    return alert('‚ö†Ô∏è Preencha todos os campos!');
                }
                
                if (users[newUsername]) {
                    return alert('‚ö†Ô∏è Usu√°rio j√° existe!');
                }

                setUsers({
                    ...users,
                    [newUsername]: { password: newPassword, name: newName, role: newRole }
                });

                setNewUsername('');
                setNewPassword('');
                setNewName('');
                alert('‚úÖ Usu√°rio adicionado!');
            };

            const deleteUser = (username) => {
                if (username === 'admin') return alert('‚ö†Ô∏è N√£o pode excluir admin!');
                if (!confirm(`Excluir ${username}?`)) return;
                
                const newUsers = { ...users };
                delete newUsers[username];
                setUsers(newUsers);
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold">üë• Gerenciar Usu√°rios</h2>
                            <button onClick={onClose}><Icon type="x" size={24} /></button>
                        </div>

                        <div className="bg-blue-50 p-4 rounded-lg mb-6">
                            <h3 className="font-bold mb-3">‚ûï Novo Usu√°rio</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mb-3">
                                <input
                                    type="text"
                                    placeholder="Login"
                                    value={newUsername}
                                    onChange={(e) => setNewUsername(e.target.value)}
                                    className="p-3 border-2 rounded-lg"
                                />
                                <input
                                    type="text"
                                    placeholder="Nome completo"
                                    value={newName}
                                    onChange={(e) => setNewName(e.target.value)}
                                    className="p-3 border-2 rounded-lg"
                                />
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mb-3">
                                <input
                                    type="password"
                                    placeholder="Senha"
                                    value={newPassword}
                                    onChange={(e) => setNewPassword(e.target.value)}
                                    className="p-3 border-2 rounded-lg"
                                />
                                <select
                                    value={newRole}
                                    onChange={(e) => setNewRole(e.target.value)}
                                    className="p-3 border-2 rounded-lg"
                                >
                                    <option value="alimentador">Alimentador</option>
                                    <option value="observador">Observador</option>
                                    <option value="admin">Admin</option>
                                </select>
                            </div>
                            <button
                                onClick={addUser}
                                className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 font-semibold"
                            >
                                Adicionar
                            </button>
                        </div>

                        <div className="space-y-3">
                            {Object.entries(users).map(([username, userData]) => (
                                <div key={username} className="border-2 rounded-lg p-4 flex justify-between items-center">
                                    <div>
                                        <p className="font-bold">{userData.name}</p>
                                        <p className="text-sm text-gray-600">@{username} - {userData.role}</p>
                                    </div>
                                    {username !== 'admin' && (
                                        <button onClick={() => deleteUser(username)} className="text-red-600">
                                            <Icon type="trash" size={20} />
                                        </button>
                                    )}
                                </div>
                            ))}
                        </div>

                        <button
                            onClick={onClose}
                            className="w-full mt-6 bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700"
                        >
                            Fechar
                        </button>
                    </div>
                </div>
            );
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // GERENCIAR TURMAS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function ManageClasses({ classes, setClasses, onClose }) {
            const [newClassName, setNewClassName] = useState('');
            const [studentNames, setStudentNames] = useState('');

            const addClass = () => {
                if (!newClassName || !studentNames) {
                    return alert('‚ö†Ô∏è Preencha turma e alunos!');
                }
                
                const students = studentNames
                    .split('\n')
                    .filter(s => s.trim())
                    .map((name, idx) => ({
                        id: Date.now() + idx,
                        name: name.trim(),
                        status: STUDENT_STATUS.ATIVO,
                        observations: {}
                    }));
                
                setClasses([...classes, { 
                    id: Date.now(), 
                    name: newClassName, 
                    students 
                }]);
                
                setNewClassName('');
                setStudentNames('');
                alert('‚úÖ Turma adicionada!');
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold">üìö Gerenciar Turmas</h2>
                            <button onClick={onClose}><Icon type="x" size={24} /></button>
                        </div>

                        <div className="bg-blue-50 p-4 rounded-lg mb-6">
                            <h3 className="font-bold mb-3">‚ûï Nova Turma</h3>
                            <input
                                type="text"
                                placeholder="Nome da Turma (ex: 5¬∫ Ano A)"
                                value={newClassName}
                                onChange={(e) => setNewClassName(e.target.value)}
                                className="w-full p-3 border-2 rounded-lg mb-3"
                            />
                            <textarea
                                placeholder="Cole nomes dos alunos (um por linha)"
                                value={studentNames}
                                onChange={(e) => setStudentNames(e.target.value)}
                                className="w-full p-3 border-2 rounded-lg h-32 mb-3"
                            />
                            <button
                                onClick={addClass}
                                className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 font-semibold"
                            >
                                Adicionar Turma
                            </button>
                        </div>

                        <div className="space-y-4">
                            {classes.map(cls => (
                                <div key={cls.id} className="border-2 rounded-lg p-4">
                                    <h4 className="font-bold text-lg">{cls.name}</h4>
                                    <p className="text-sm text-gray-600">{cls.students.length} alunos</p>
                                </div>
                            ))}
                        </div>

                        <button
                            onClick={onClose}
                            className="w-full mt-6 bg-gray-600 text-white py-3 rounded-lg"
                        >
                            Fechar
                        </button>
                    </div>
                </div>
            );
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // GERENCIAR ALUNOS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function ManageStudents({ selectedClass, classes, setClasses, onClose }) {
            const [newStudentName, setNewStudentName] = useState('');

            const addStudent = () => {
                if (!newStudentName.trim()) return alert('‚ö†Ô∏è Digite o nome!');

                setClasses(prev => prev.map(cls => {
                    if (cls.id === selectedClass.id) {
                        return {
                            ...cls,
                            students: [...cls.students, {
                                id: Date.now(),
                                name: newStudentName.trim(),
                                status: STUDENT_STATUS.ATIVO,
                                observations: {}
                            }]
                        };
                    }
                    return cls;
                }));

                setNewStudentName('');
                alert('‚úÖ Aluno adicionado!');
            };

            const changeStatus = (studentId, newStatus) => {
                setClasses(prev => prev.map(cls => {
                    if (cls.id === selectedClass.id) {
                        return {
                            ...cls,
                            students: cls.students.map(s => 
                                s.id === studentId ? { ...s, status: newStatus } : s
                            )
                        };
                    }
                    return cls;
                }));
            };

            const currentClass = classes.find(c => c.id === selectedClass.id);

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold">üë®‚Äçüéì Alunos - {selectedClass.name}</h2>
                            <button onClick={onClose}><Icon type="x" size={24} /></button>
                        </div>

                        <div className="bg-blue-50 p-4 rounded-lg mb-6">
                            <div className="flex gap-3">
                                <input
                                    type="text"
                                    placeholder="Nome do aluno"
                                    value={newStudentName}
                                    onChange={(e) => setNewStudentName(e.target.value)}
                                    className="flex-1 p-3 border-2 rounded-lg"
                                    onKeyPress={(e) => e.key === 'Enter' && addStudent()}
                                />
                                <button
                                    onClick={addStudent}
                                    className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700"
                                >
                                    Adicionar
                                </button>
                            </div>
                        </div>

                        <div className="space-y-3">
                            {currentClass?.students.map(student => (
                                <div key={student.id} className="border-2 rounded-lg p-4">
                                    <p className="font-bold mb-2">{student.name}</p>
                                    <select
                                        value={student.status}
                                        onChange={(e) => changeStatus(student.id, e.target.value)}
                                        className="w-full p-2 border-2 rounded-lg text-sm"
                                    >
                                        <option value={STUDENT_STATUS.ATIVO}>‚úÖ Ativo</option>
                                        <option value={STUDENT_STATUS.TRANSFERIDO}>üîÑ Transferido</option>
                                        <option value={STUDENT_STATUS.FALECIDO}>üïäÔ∏è Falecido</option>
                                    </select>
                                </div>
                            ))}
                        </div>

                        <button onClick={onClose} className="w-full mt-6 bg-gray-600 text-white py-3 rounded-lg">
                            Fechar
                        </button>
                    </div>
                </div>
            );
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // RELAT√ìRIOS - COM C√ÅLCULO CORRETO PARA TRANSFERIDOS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function Reports({ selectedClass, classes }) {
            const currentClass = classes.find(c => c.id === selectedClass?.id);
            if (!currentClass) return <div className="p-6">Selecione uma turma</div>;

            const calculateStats = () => {
                return currentClass.students.map(student => {
                    const observations = Object.entries(student.observations);
                    const totalDays = observations.length;
                    const presentDays = observations.filter(([_, data]) => data.presente).length;
                    
                    const percentage = totalDays > 0 ? ((presentDays / totalDays) * 100).toFixed(1) : 0;

                    return {
                        name: student.name,
                        status: student.status,
                        totalDays,
                        presentDays,
                        absentDays: totalDays - presentDays,
                        percentage: parseFloat(percentage)
                    };
                }).sort((a, b) => b.percentage - a.percentage);
            };

            const stats = calculateStats();

            return (
                <div className="p-6">
                    <div className="flex justify-between items-center mb-6 no-print">
                        <h2 className="text-2xl font-bold">üìä Relat√≥rio - {currentClass.name}</h2>
                        <button
                            onClick={() => window.print()}
                            className="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 flex items-center gap-2"
                        >
                            <Icon type="printer" size={20} />
                            Imprimir
                        </button>
                    </div>

                    <div className="bg-white border-2 rounded-lg overflow-hidden">
                        <table className="w-full">
                            <thead className="bg-gray-100">
                                <tr>
                                    <th className="px-4 py-3 text-left">Aluno</th>
                                    <th className="px-4 py-3 text-center">Status</th>
                                    <th className="px-4 py-3 text-center">Dias</th>
                                    <th className="px-4 py-3 text-center">Presen√ßas</th>
                                    <th className="px-4 py-3 text-center">Faltas</th>
                                    <th className="px-4 py-3 text-center">Frequ√™ncia</th>
                                </tr>
                            </thead>
                            <tbody>
                                {stats.map((stat, index) => (
                                    <tr key={index} className="border-t hover:bg-gray-50">
                                        <td className="px-4 py-3 font-medium">{stat.name}</td>
                                        <td className="px-4 py-3 text-center">
                                            {stat.status === STUDENT_STATUS.ATIVO && '‚úÖ'}
                                            {stat.status === STUDENT_STATUS.TRANSFERIDO && 'üîÑ'}
                                            {stat.status === STUDENT_STATUS.FALECIDO && 'üïäÔ∏è'}
                                        </td>
                                        <td className="px-4 py-3 text-center">{stat.totalDays}</td>
                                        <td className="px-4 py-3 text-center text-green-600 font-semibold">
                                            {stat.presentDays}
                                        </td>
                                        <td className="px-4 py-3 text-center text-red-600 font-semibold">
                                            {stat.absentDays}
                                        </td>
                                        <td className="px-4 py-3">
                                            <div className="flex items-center gap-2">
                                                <div className="flex-1 bg-gray-200 rounded-full h-6">
                                                    <div 
                                                        className="percentage-bar h-full bg-green-600 rounded-full"
                                                        style={{ width: `${stat.percentage}%` }}
                                                    />
                                                </div>
                                                <span className="font-bold text-sm w-12 text-right">
                                                    {stat.percentage}%
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>

                    <div className="mt-4 p-4 bg-blue-50 rounded-lg text-sm text-blue-800">
                        <strong>‚ÑπÔ∏è Nota:</strong> A porcentagem mostra a frequ√™ncia real do aluno 
                        no per√≠odo em que esteve matriculado, independente do status atual.
                    </div>
                </div>
            );
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // REGISTRO DE PRESEN√áA
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function AttendanceRegister({ selectedClass, selectedDate, classes, setClasses, canEdit }) {
            const currentClass = classes.find(c => c.id === selectedClass?.id);
            if (!currentClass) return <div className="p-6">Selecione uma turma</div>;

            const togglePresence = (studentId) => {
                if (!canEdit) return alert('‚ö†Ô∏è Sem permiss√£o');
                
                const student = currentClass.students.find(s => s.id === studentId);
                if (student.status !== STUDENT_STATUS.ATIVO) {
                    return alert(`‚ö†Ô∏è Aluno est√° ${student.status}`);
                }

                setClasses(prev => prev.map(cls => {
                    if (cls.id === selectedClass.id) {
                        return {
                            ...cls,
                            students: cls.students.map(student => {
                                if (student.id === studentId) {
                                    const observations = { ...student.observations };
                                    if (!observations[selectedDate]) {
                                        observations[selectedDate] = { presente: true, observacao: '' };
                                    } else {
                                        observations[selectedDate].presente = !observations[selectedDate].presente;
                                    }
                                    return { ...student, observations };
                                }
                                return student;
                            })
                        };
                    }
                    return cls;
                }));
            };

            const addObservation = (studentId, text) => {
                if (!canEdit) return;

                setClasses(prev => prev.map(cls => {
                    if (cls.id === selectedClass.id) {
                        return {
                            ...cls,
                            students: cls.students.map(student => {
                                if (student.id === studentId) {
                                    const observations = { ...student.observations };
                                    if (!observations[selectedDate]) {
                                        observations[selectedDate] = { presente: false, observacao: text };
                                    } else {
                                        observations[selectedDate].observacao = text;
                                    }
                                    return { ...student, observations };
                                }
                                return student;
                            })
                        };
                    }
                    return cls;
                }));
            };

            return (
                <div className="p-6">
                    <h2 className="text-2xl font-bold mb-6">‚úèÔ∏è Presen√ßa - {currentClass.name}</h2>

                    <div className="space-y-3">
                        {currentClass.students.map(student => {
                            const dayData = student.observations[selectedDate] || { presente: false, observacao: '' };
                            const isBlocked = student.status !== STUDENT_STATUS.ATIVO;

                            return (
                                <div
                                    key={student.id}
                                    className={`border-2 rounded-lg p-4 ${isBlocked ? 'bg-gray-100 opacity-60' : ''}`}
                                >
                                    <div className="flex items-center gap-3 mb-3">
                                        <button
                                            onClick={() => togglePresence(student.id)}
                                            disabled={!canEdit || isBlocked}
                                            className={`w-12 h-12 rounded-lg font-bold text-lg ${
                                                dayData.presente ? 'bg-green-500' : 'bg-red-500'
                                            } text-white ${!canEdit || isBlocked ? 'opacity-50' : 'hover:scale-105'}`}
                                        >
                                            {dayData.presente ? 'P' : 'F'}
                                        </button>
                                        <div>
                                            <p className="font-bold">{student.name}</p>
                                            {isBlocked && (
                                                <p className="text-xs text-orange-600">
                                                    {student.status === STUDENT_STATUS.TRANSFERIDO && 'üîÑ Transferido'}
                                                    {student.status === STUDENT_STATUS.FALECIDO && 'üïäÔ∏è Falecido'}
                                                </p>
                                            )}
                                        </div>
                                    </div>

                                    {!isBlocked && (
                                        <input
                                            type="text"
                                            placeholder="Observa√ß√£o (opcional)"
                                            value={dayData.observacao}
                                            onChange={(e) => addObservation(student.id, e.target.value)}
                                            disabled={!canEdit}
                                            className="w-full p-2 border-2 rounded-lg text-sm"
                                        />
                                    )}
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // APP PRINCIPAL
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function App() {
            const [user, setUser] = useState(null);
            const [users, setUsers] = useState(() => {
                const saved = localStorage.getItem('systemUsers');
                return saved ? JSON.parse(saved) : DEFAULT_USERS;
            });
            const [classes, setClasses] = useState([]);
            const [selectedClass, setSelectedClass] = useState(null);
            const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
            const [activeTab, setActiveTab] = useState('registro');
            const [showManageClasses, setShowManageClasses] = useState(false);
            const [showManageUsers, setShowManageUsers] = useState(false);
            const [showManageStudents, setShowManageStudents] = useState(false);
            const [showConfig, setShowConfig] = useState(false);
            const [showChangeCredentials, setShowChangeCredentials] = useState(false);
            const [syncing, setSyncing] = useState(false);
            const [lastSync, setLastSync] = useState(null);

            useEffect(() => {
                const savedUser = localStorage.getItem('currentUser');
                if (savedUser) setUser(JSON.parse(savedUser));
                loadData();
            }, []);

            useEffect(() => {
                localStorage.setItem('systemUsers', JSON.stringify(users));
            }, [users]);

            useEffect(() => {
                if (classes.length > 0) {
                    localStorage.setItem('frequenciaEscolar_turmas', JSON.stringify(classes));
                }
            }, [classes]);

            const loadData = async () => {
                try {
                    const cloudData = await SyncManager.load();
                    if (cloudData?.classes) {
                        setClasses(cloudData.classes);
                        setLastSync(cloudData.lastSync);
                        if (cloudData.users) setUsers(cloudData.users);
                        return;
                    }
                } catch {}

                const savedData = localStorage.getItem('frequenciaEscolar_turmas');
                if (savedData) setClasses(JSON.parse(savedData));
            };

            const handleSync = async () => {
                setSyncing(true);
                try {
                    await SyncManager.save({ classes, users });
                    setLastSync(new Date().toISOString());
                    alert('‚úÖ Sincronizado com sucesso!');
                    await loadData();
                } catch (error) {
                    alert('‚ùå Erro ao sincronizar. Verifique a API Key.');
                } finally {
                    setSyncing(false);
                }
            };

            if (!user) {
                return <LoginScreen onLogin={(u) => {
                    setUser(u);
                    localStorage.setItem('currentUser', JSON.stringify(u));
                }} users={users} />;
            }

            return (
                <div className="min-h-screen bg-gray-100">
                    {/* Header */}
                    <div className="bg-indigo-600 text-white p-4 shadow-lg no-print">
                        <div className="max-w-6xl mx-auto flex justify-between items-center">
                            <div>
                                <h1 className="text-xl font-bold">üìö Frequ√™ncia Escolar</h1>
                                <p className="text-sm opacity-90">{user.name}</p>
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setShowChangeCredentials(true)}
                                    className="bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 flex items-center gap-2"
                                    title="Trocar senha/usu√°rio"
                                >
                                    <Icon type="edit" size={20} />
                                </button>
                                <button
                                    onClick={() => setShowConfig(true)}
                                    className="bg-white text-indigo-600 px-4 py-2 rounded-lg hover:bg-gray-100 flex items-center gap-2"
                                >
                                    <Icon type="settings" size={20} />
                                </button>
                                <button
                                    onClick={handleSync}
                                    disabled={syncing}
                                    className="bg-white text-indigo-600 px-4 py-2 rounded-lg hover:bg-gray-100 disabled:opacity-50 flex items-center gap-2"
                                >
                                    <div className={syncing ? 'animate-spin' : ''}>
                                        <Icon type="cloud" size={20} />
                                    </div>
                                    {syncing ? 'Sincronizando...' : 'Sincronizar'}
                                </button>
                                <button
                                    onClick={() => {
                                        setUser(null);
                                        localStorage.removeItem('currentUser');
                                    }}
                                    className="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 flex items-center gap-2"
                                >
                                    <Icon type="logout" size={20} />
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Controles */}
                    <div className="max-w-6xl mx-auto p-4 no-print">
                        <div className="bg-white rounded-lg shadow p-4 mb-4">
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label className="block text-sm font-semibold mb-2">Turma:</label>
                                    <select
                                        value={selectedClass?.id || ''}
                                        onChange={(e) => setSelectedClass(classes.find(c => c.id === parseInt(e.target.value)))}
                                        className="w-full p-3 border-2 rounded-lg"
                                    >
                                        <option value="">Selecione</option>
                                        {classes.map(cls => (
                                            <option key={cls.id} value={cls.id}>
                                                {cls.name} ({cls.students.length} alunos)
                                            </option>
                                        ))}
                                    </select>
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold mb-2">Data:</label>
                                    <input
                                        type="date"
                                        value={selectedDate}
                                        onChange={(e) => setSelectedDate(e.target.value)}
                                        className="w-full p-3 border-2 rounded-lg"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold mb-2">Gerenciar:</label>
                                    <div className="flex gap-2">
                                        {user.canManageUsers && (
                                            <button
                                                onClick={() => setShowManageUsers(true)}
                                                className="flex-1 bg-purple-600 text-white px-3 py-2 rounded-lg hover:bg-purple-700"
                                            >
                                                <Icon type="users" size={18} />
                                            </button>
                                        )}
                                        {user.canManageStudents && (
                                            <>
                                                <button
                                                    onClick={() => setShowManageClasses(true)}
                                                    className="flex-1 bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 text-sm"
                                                >
                                                    Turmas
                                                </button>
                                                <button
                                                    onClick={() => selectedClass && setShowManageStudents(true)}
                                                    disabled={!selectedClass}
                                                    className="flex-1 bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm"
                                                >
                                                    Alunos
                                                </button>
                                            </>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Tabs */}
                        <div className="bg-white rounded-lg shadow mb-4">
                            <div className="flex border-b">
                                <button
                                    onClick={() => setActiveTab('registro')}
                                    className={`flex-1 py-3 font-semibold ${
                                        activeTab === 'registro'
                                            ? 'border-b-4 border-indigo-600 text-indigo-600'
                                            : 'text-gray-600'
                                    }`}
                                >
                                    ‚úèÔ∏è Registro
                                </button>
                                <button
                                    onClick={() => setActiveTab('relatorio')}
                                    className={`flex-1 py-3 font-semibold ${
                                        activeTab === 'relatorio'
                                            ? 'border-b-4 border-indigo-600 text-indigo-600'
                                            : 'text-gray-600'
                                    }`}
                                >
                                    üìä Relat√≥rios
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Conte√∫do */}
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-lg shadow">
                            {activeTab === 'registro' && (
                                <AttendanceRegister
                                    selectedClass={selectedClass}
                                    selectedDate={selectedDate}
                                    classes={classes}
                                    setClasses={setClasses}
                                    canEdit={user.canEdit}
                                />
                            )}
                            {activeTab === 'relatorio' && (
                                <Reports selectedClass={selectedClass} classes={classes} />
                            )}
                        </div>
                    </div>

                    {/* Modals */}
                    {showChangeCredentials && (
                        <ChangeCredentialsModal
                            user={user}
                            users={users}
                            setUsers={setUsers}
                            onClose={() => setShowChangeCredentials(false)}
                            onUpdate={setUser}
                        />
                    )}
                    {showConfig && (
                        <ConfigModal
                            onClose={() => setShowConfig(false)}
                            onSave={(key) => localStorage.setItem('jsonbin_api_key', key)}
                        />
                    )}
                    {showManageUsers && (
                        <ManageUsers users={users} setUsers={setUsers} onClose={() => setShowManageUsers(false)} />
                    )}
                    {showManageClasses && (
                        <ManageClasses classes={classes} setClasses={setClasses} onClose={() => setShowManageClasses(false)} />
                    )}
                    {showManageStudents && selectedClass && (
                        <ManageStudents selectedClass={selectedClass} classes={classes} setClasses={setClasses} onClose={() => setShowManageStudents(false)} />
                    )}

                    {/* Status */}
                    {lastSync && (
                        <div className="max-w-6xl mx-auto p-4 no-print">
                            <p className="text-center text-sm text-gray-500">
                                ‚òÅÔ∏è √öltima sincroniza√ß√£o: {new Date(lastSync).toLocaleString('pt-BR')}
                            </p>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));

        // PWA
        const manifest = {
            name: "Frequ√™ncia Escolar Pro",
            short_name: "Frequ√™ncia",
            start_url: ".",
            display: "standalone",
            background_color: "#ffffff",
            theme_color: "#6366f1",
            icons: [{ 
                src: "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üìö</text></svg>", 
                sizes: "512x512", 
                type: "image/svg+xml" 
            }]
        };
        
        const manifestBlob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
        const manifestURL = URL.createObjectURL(manifestBlob);
        document.getElementById('manifest-placeholder').setAttribute('href', manifestURL);
    </script>
</body>
</html>
